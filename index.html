<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cinematic Lightning Intro</title>
  <style>
    :root{
      --intro-bg:#0a0c18;           /* deep night */
      --intro-bg-2:#141b3a;         /* indigo */
      --flash-color:#ffffff;        /* screen flash */
      --bolt-color:#bfe8ff;         /* pale blue-white */
      --bolt-core:#ffffff;          /* bolt hot core */
      --glow-outer:#6fd0ff;         /* cyan outer glow */
      --fade-duration:900ms;        /* overlay fade out */
      --overlay-z: 9999;
    }

    html,body{ height:100%; margin:0; background:#0b0e12; color:#e7ecf3; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; }

    /* === Intro Overlay === */
    .intro-overlay{ position:fixed; inset:0; z-index:var(--overlay-z);
      background: radial-gradient(120% 100% at 70% 20%, var(--intro-bg-2) 0%, var(--intro-bg) 50%, #06070f 100%);
      display:grid; place-items:center; overflow:hidden; }
    .intro-overlay[hidden]{ display:none; }

    /* Contain the SVG and flashes */
    .stage{ position:relative; width:100vw; height:100vh; }

    /* Global flash panel */
    .flash{
      position:absolute; inset:0; background:var(--flash-color); opacity:0; pointer-events:none;
      mix-blend-mode:screen;
    }

    /* Subtle rain noise overlay (adds atmosphere) */
    .noise{ position:absolute; inset:0; opacity:0.035; pointer-events:none; filter:contrast(150%); mix-blend-mode:soft-light; }

    /* Skip button (for dev / accessibility) */
    .skip{
      position:absolute; right:16px; top:16px; z-index:2; background:#10131a; color:#cfe9ff; border:1px solid #284157;
      padding:8px 12px; border-radius:999px; font-size:14px; cursor:pointer; opacity:.85; transition:.2s;
    }
    .skip:hover{ opacity:1; transform:translateY(-1px); }

    /* Main site content initially hidden until intro completes */
    .site{ opacity:0; transform:scale(0.985); transition:opacity .5s ease, transform .6s ease; }
    .site.ready{ opacity:1; transform:none; }

    /* Reduced motion: skip fancy parts but still reveal content gracefully */
    @media (prefers-reduced-motion: reduce){
      .intro-overlay{ display:none !important; }
      .site{ opacity:1 !important; transform:none !important; }
    }

    /* Subtle dim vignette during intro for cinematic framing */
    .vignette:before{
      content:""; position:absolute; inset:-10%; pointer-events:none;
      background: radial-gradient(ellipse at center, rgba(0,0,0,0) 40%, rgba(0,0,0,.65) 100%);
      mix-blend-mode:multiply; opacity:.9;
    }
  </style>
</head>
<body>

  <!-- Intro Overlay -->
  <div class="intro-overlay" id="intro" aria-hidden="true">
    <div class="stage vignette">
      <button class="skip" id="skipIntro" aria-label="Skip intro">Skip</button>
      <div class="flash" id="flash"></div>
      <svg id="boltSvg" width="100%" height="100%" viewBox="0 0 1000 1000" preserveAspectRatio="none">
        <defs>
          <!-- Soft neon glow for the bolt -->
          <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur in="SourceGraphic" stdDeviation="2.5" result="b1"/>
            <feGaussianBlur in="SourceGraphic" stdDeviation="6" result="b2"/>
            <feGaussianBlur in="SourceGraphic" stdDeviation="14" result="b3"/>
            <feMerge>
              <feMergeNode in="b3"/>
              <feMergeNode in="b2"/>
              <feMergeNode in="b1"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>

          <!-- Gradient stroke to mimic the faceted blue fill from your logo -->
          <linearGradient id="boltGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#8be4ff"/>
            <stop offset="45%" stop-color="#49b9ff"/>
            <stop offset="100%" stop-color="#2273ff"/>
          </linearGradient>

          <!-- Noise for shimmer -->
          <filter id="electricNoise" x="-20%" y="-20%" width="140%" height="140%">
            <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" seed="13" stitchTiles="stitch" result="turb"/>
            <feColorMatrix type="saturate" values="0"/>
            <feComponentTransfer>
              <feFuncA type="table" tableValues="0 0.75"/>
            </feComponentTransfer>
          </filter>
        </defs>

        <!-- Main bolt path: top-right to bottom-left (cinematic diagonal) -->
        <g id="bolt" filter="url(#glow)">
          <!-- Outline stack (black, then white) for that sticker-like border from your logo -->
          <path id="outlineOuter" d="M 960 40 C 880 120, 850 160, 780 210 S 700 290, 660 330 S 610 400, 540 460 S 470 520, 430 560 S 360 640, 300 700 S 240 750, 140 840" fill="none" stroke="#000" stroke-width="14" stroke-linecap="round" stroke-linejoin="round" opacity=".88"/>
          <path id="outlineInner" d="M 960 40 C 880 120, 850 160, 780 210 S 700 290, 660 330 S 610 400, 540 460 S 470 520, 430 560 S 360 640, 300 700 S 240 750, 140 840" fill="none" stroke="#ffffff" stroke-width="10" stroke-linecap="round" stroke-linejoin="round" opacity=".95"/>

          <!-- Corona with blue gradient -->
          <path id="corona" d="M 960 40 C 880 120, 850 160, 780 210 S 700 290, 660 330 S 610 400, 540 460 S 470 520, 430 560 S 360 640, 300 700 S 240 750, 140 840" fill="none" stroke="url(#boltGrad)" stroke-width="8" stroke-linecap="round" stroke-linejoin="round" opacity="0.9"/>

          <!-- Hot core (white) -->
          <path id="core" d="M 960 40 C 880 120, 850 160, 780 210 S 700 290, 660 330 S 610 400, 540 460 S 470 520, 430 560 S 360 640, 300 700 S 240 750, 140 840" fill="none" stroke="var(--bolt-core)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" />

          <!-- Side branches (forks) -->
          <path class="branch" d="M 700 290 C 680 320, 640 340, 600 360" fill="none" stroke="url(#boltGrad)" stroke-width="3" stroke-linecap="round"/>
          <path class="branch" d="M 610 400 C 590 430, 560 450, 530 470" fill="none" stroke="url(#boltGrad)" stroke-width="3" stroke-linecap="round"/>
          <path class="branch" d="M 470 520 C 450 545, 420 560, 395 575" fill="none" stroke="url(#boltGrad)" stroke-width="3" stroke-linecap="round"/>
          <path class="branch" d="M 360 640 C 340 665, 310 685, 280 705" fill="none" stroke="url(#boltGrad)" stroke-width="3" stroke-linecap="round"/>

          <!-- Spark stars -->
          <g id="stars" fill="#ffffff" opacity="0.0">
            <polygon points="780,210 786,213 780,216 777,222 774,216 768,213 774,210 777,204"/>
            <polygon points="540,460 544,462 540,465 538,469 536,465 532,462 536,460 538,456"/>
            <polygon points="300,700 304,702 300,705 298,709 296,705 292,702 296,700 298,696"/>
          </g>

          <!-- Crackle shards -->
          <g id="shards" stroke="#ffffff" stroke-width="2" opacity="0.0">
            <line x1="760" y1="220" x2="746" y2="228"/>
            <line x1="620" y1="390" x2="610" y2="402"/>
            <line x1="430" y1="560" x2="418" y2="570"/>
          </g>
        </g>

        <!-- Subtle electric shimmer overlay using noise (animated via CSS/JS) -->
        <rect class="noise" id="noise" x="0" y="0" width="1000" height="1000" filter="url(#electricNoise)"/>
      </svg>
    </div>
  </div>

  <!-- Your actual site content goes here -->
  <main class="site" id="site">
    <section style="max-width:960px; margin:10vh auto; padding:24px; background:#0f131a; border:1px solid #1d2633; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,.35)">
      <h1 style="margin:0 0 8px 0; font-size:42px; letter-spacing:.3px;">Your Website</h1>
      <p style="opacity:.85; line-height:1.6">This is your normal page content. The cinematic lightning intro runs once on first load, then the site appears like this.</p>
      <p style="opacity:.7;">Replace this with your real homepage.</p>
    </section>
  </main>

  <!-- Optional thunder audio (royalty-free clip path needed) -->
  <audio id="thunderAudio" preload="auto">
    <!-- <source src="/audio/thunder.mp3" type="audio/mpeg"> -->
  </audio>

  <!-- GSAP CDN -->
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>

  <script>
    (function(){
      const overlay = document.getElementById('intro');
      const site    = document.getElementById('site');
      const flash   = document.getElementById('flash');
      const svg     = document.getElementById('boltSvg');
      const core    = document.getElementById('core');
      const corona  = document.getElementById('corona');
      const branches= Array.from(svg.querySelectorAll('.branch'));
      const skipBtn = document.getElementById('skipIntro');
      const thunder = document.getElementById('thunderAudio');

      const ONCE_PER_SESSION = true; // change to false to replay each refresh
      const STORAGE_KEY = 'cinematicLightningShown';

      // Respect user preference or repeat logic
      if(ONCE_PER_SESSION && sessionStorage.getItem(STORAGE_KEY)){
        // Skip the intro entirely
        overlay.setAttribute('hidden', 'true');
        site.classList.add('ready');
        return;
      }

      // Accessibility: allow skipping
      skipBtn.addEventListener('click', endIntroNow);
      document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') endIntroNow(); });

      // Helper to set up dash pattern so strokes "draw" in
      function prepPath(path){
        const len = path.getTotalLength();
        path.style.strokeDasharray = len + ' ' + len;
        path.style.strokeDashoffset = len;
        return len;
      }

      const coreLen   = prepPath(core);
      const coronaLen = prepPath(corona);
      const branchLens= branches.map(prepPath);

      // Cinematic timeline
      const tl = gsap.timeline({ defaults:{ ease:'power3.out' }});

      // Initial darkness
      gsap.set(flash, { opacity:0 });
      gsap.set('#noise', { opacity:0.02 });

      // Slight camera pre-shake anticipation
      tl.to('.stage', { x:-2, y:-2, duration:0.08, ease:'power2.inOut' }, 0);

      // First faint pre-flash
      tl.to(flash, { opacity:0.15, duration:0.05, ease:'power2.out' }, 0.02)
        .to(flash, { opacity:0, duration:0.12, ease:'power2.in' }, ">-0.02");

      // Main strike: quick draw of core + corona
      tl.addLabel('strike', ">")
        .to(core,   { strokeDashoffset:0, duration:0.15, ease:'power1.in' }, 'strike')
        .to(corona, { strokeDashoffset:0, duration:0.22, ease:'power1.in' }, 'strike+=0.02')
        .to('#noise', { opacity:0.06, duration:0.2 }, 'strike');

      // Branches erupt just after main
      branches.forEach((b,i)=>{
        tl.to(b, { strokeDashoffset:0, duration:0.12 + i*0.02, ease:'power1.in' }, 'strike+=0.04');
      });

      // Screen flash & camera shake timed with strike
      tl.to(flash, { opacity:0.98, duration:0.06, ease:'power4.out' }, 'strike+=0.02')
        .to('.stage', { x:0, y:0, duration:0.05, ease:'power1.in' }, 'strike+=0.03')
        .to('.stage', { x:6, y:-4, duration:0.06, ease:'power1.inOut' }, 'strike+=0.06')
        .to('.stage', { x:-3, y:2, duration:0.08, ease:'power1.inOut' }, 'strike+=0.12')
        .to('.stage', { x:0, y:0, duration:0.12, ease:'power2.out' }, 'strike+=0.18')
        .to(flash, { opacity:0.35, duration:0.12 }, 'strike+=0.12')
        .to(flash, { opacity:0.0, duration:0.28, ease:'power2.in' }, 'strike+=0.24');

      // Pop in stars & shards
      tl.to('#stars', { opacity:1, duration:0.08, ease:'power1.out' }, 'strike+=0.04')
        .to('#stars', { opacity:0, duration:0.4 }, 'strike+=0.28')
        .to('#shards', { opacity:1, duration:0.06 }, 'strike+=0.05')
        .to('#shards', { opacity:0, duration:0.35 }, 'strike+=0.30');

      // Post-strike flicker (bolt lingers & sizzles), then decay
      tl.to([core,corona], { opacity:0.95, duration:0.05 }, 'strike+=0.02')
        .to([core,corona], { opacity:0.7, duration:0.06 }, 'strike+=0.16')
        .to([core,corona], { opacity:0.92, duration:0.05 }, 'strike+=0.23')
        .to([core,corona], { opacity:0.55, duration:0.08 }, 'strike+=0.32')
        .to([core,corona], { opacity:0.0, duration:0.35, ease:'power2.in' }, 'strike+=0.50')
        .to('#noise', { opacity:0.02, duration:0.5 }, 'strike+=0.30');

      // Optional thunder: play slightly after visual (speed of sound) ~300ms
      tl.call(()=>{ try{ if(thunder && thunder.play) thunder.play().catch(()=>{}); }catch(e){} }, null, 'strike+=0.30');

      // Fade out overlay and reveal site
      tl.call(()=>{
        overlay.style.transition = `opacity var(--fade-duration) ease`;
        overlay.style.opacity = 0;
        setTimeout(()=>{
          overlay.setAttribute('hidden','true');
          site.classList.add('ready');
          if(ONCE_PER_SESSION) sessionStorage.setItem(STORAGE_KEY, '1');
        }, 900);
      }, null, ">+0.15");

      // Safety timeout (if anything stalls, reveal site after ~4.5s)
      setTimeout(()=>{
        if(!overlay.hasAttribute('hidden')){
          overlay.setAttribute('hidden','true');
          site.classList.add('ready');
          if(ONCE_PER_SESSION) sessionStorage.setItem(STORAGE_KEY, '1');
        }
      }, 4500);

      function endIntroNow(){
        tl.kill();
        overlay.setAttribute('hidden','true');
        site.classList.add('ready');
        if(ONCE_PER_SESSION) sessionStorage.setItem(STORAGE_KEY, '1');
      }

      // Small atmospheric shimmer loop (subtle, not GPU heavy)
      gsap.to('#noise', { opacity:0.045, duration:1.2, yoyo:true, repeat:-1, ease:'sine.inOut' });
    })();
  </script>
</body>
</html>
